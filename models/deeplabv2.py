"""Code based on
https://raw.githubusercontent.com/yzou2/CRST/fce34003d